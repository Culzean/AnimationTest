var Animate=function(){function n(n,t){this.catapultVel=200,this.start=new createjs.Point(0,0),this.frame=0,this.frameCount=100,this.crtEase=0,p=this,this.model=n,this.view=t}return n.prototype.Init=function(){this.backGround=new createjs.Bitmap(this.model.getAsset("background")),this.backGround.scaleX=this.model.gameWidth/256,this.backGround.scaleY=this.model.gameHeight/150,this.view.stage.addChild(this.backGround);var t=this.model.getAsset("catapult"),n=new createjs.SpriteSheet({images:[t],frames:{width:128,height:128,regX:64,regY:64},animations:{move_right:[0,0,"move_right",16],move_left:[13,14,"move_left",16],fire_on_right:[0,5,"fire_on_right",6],fire_off_right:[6,11,"fire_off_right",4],fire_left:[12,23,"fireon_left",12],ready_left:[12,12,"ready_left",12],ready_right:[0,0,"ready_right",12]}});createjs.SpriteSheetUtils.addFlippedFrames(n,!0,!1,!1),this.catapult=new createjs.BitmapAnimation(n),n=new createjs.SpriteSheet({images:[this.model.getAsset("buttons")],frames:{width:128,height:42,regX:64,regY:21},animations:{out:[0,0,"out",0],over:[1,1,"over",0],click:[2,2,"click",0],hit:[0,0,"hit",0]}}),this.buttonsAnim=new createjs.BitmapAnimation(n),this.buttons=new createjs.ButtonHelper(this.buttonsAnim,"out","over","click",!1,null,"hit"),this.buttons.setEnabled(!1),this.buttonsAnim.x=m.gameWidth/2-64,this.buttonsAnim.y=m.gameHeight-128,this.view.stage.addChild(this.buttonsAnim),this.view.stage.addChild(this.catapult),this.buttons.setEnabled(!0),this.buttonsAnim.addEventListener("click",this.handleButtonClick),this.catapult.x=128,this.catapult.y=m.gameHeight-196,this.catapult.onAnimationEnd=this.catapultCycle.bind(name),this.direction="right",this.action="fire_on_",this.animation=this.action+this.direction,this.catapult.gotoAndPlay(this.animation),this.catapult.play(),this.rock=new createjs.Shape,this.rock.graphics.setStrokeStyle(1),this.rock.graphics.beginStroke("#113355"),this.rock.graphics.beginFill("rgb(100,100,100)"),this.rock.graphics.drawCircle(0,0,9),this.view.stage.addChild(this.rock),this.rock.visible=!1,createjs.Ticker.setPaused(!1),this.view.stage.addEventListener("stagemouseup",this.handleMouseUp),this.ease=createjs.Ease.quadOut,p.view.stage.update()},n.prototype.catapultCycle=function(){switch(p.action){case"fire_on_":p.action="fire_off_",p.animation=p.action+p.direction,p.catapult.gotoAndPlay(p.animation),p.rock.x=p.catapult.x-4,p.rock.y=p.catapult.y-28,p.fire();break;case"fire_off_":p.action="ready_",p.animation=p.action+p.direction,p.catapult.stop();break;case"move_":p.action="ready_",p.animation=p.action+p.direction,p.catapult.gotoAndPlay(p.animation);break;case"ready_":p.action="move_",p.animation=p.action+p.direction,p.catapult.gotoAndPlay(p.animation);break;default:console.log("Animation not recognised: "+p.action)}},n.prototype.tick=function(){p.rock.isVisible()&&(p.crtEase==0?(++p.frame>p.frameCount&&(p.crtEase=1),p.rock.x=p.start.x+p.distance*(p.frame/p.frameCount),p.rock.y=p.start.y-p.ease(p.frame/p.frameCount)*100):p.crtEase==1&&(--p.frame<0&&(p.crtEase=0,p.frame=0,p.rock.visible=!1,p.action="ready_"),p.rock.x=p.start.x+p.distance+p.distance*((p.frameCount-p.frame+1)/p.frameCount),p.rock.y=p.start.y-p.ease(p.frame/p.frameCount)*100))},n.prototype.fire=function(){p.distance=Helper.RandomRange(p.model.gameWidth-400,p.model.gameWidth-300),p.crtEase=0,p.frame=0,p.start.x=p.catapult.x+20+p.distance*(p.frame/p.frameCount),p.start.y=p.catapult.y-50+p.ease(0),p.rock.visible=!0},n.prototype.handleButtonClick=function(){(p.action=="ready_"||p.action=="move_")&&(p.action="fire_on_",p.catapult.gotoAndPlay("fire_on_"+p.direction)),console.log("click! "+p.action)},n.prototype.handleMouseUp=function(){if(p.buttonsAnim.currentAnimation=="out"&&(p.action=="ready_"||p.action=="move_")){var n=1e3*(Math.abs(p.view.stage.mouseX-p.catapult.x)/p.catapultVel);p.catapultTween=createjs.Tween.get(p.catapult,{loop:!1}).to({x:p.view.stage.mouseX,y:p.catapult.y},n,createjs.Ease.backOut),p.view.stage.update()}},n.prototype.handleReady=function(){p.action="ready_"},n}(),p